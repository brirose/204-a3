---
title: "ESM 204 HW 3: Distributional consequences of climate policy"
author: "Bri Baker and Anna Talken"
date: "Spring 2021"
output:
  html_document:
    theme: cosmo
    highlight: kate
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE,
                      warning = FALSE)
library(tidyverse)
library(here)
library(janitor)
```

## Data Setup
```{r}
gas <- read_csv(here("HW3_data.csv")) %>% 
  clean_names() %>% 
  mutate(q_agg_gal = q_low_gallons + q_high_gallons)

gas_price <- 3 # $/gal
scc <- 51 # $/metric ton
ton <- 2000 # lb

```

## Question 1
```{r}
emission_gal <- 19.6 # pounds of co2 in a gallon of gas

mec <- emission_gal*(1/ton)*scc

```

The marginal external cost is $`r round(mec, 3)`/gal.


## Question 2
```{r}
d_ag <- lm(price_dollars ~ q_agg_gal, data = gas) #create linear model

d_ag_slope <- d_ag$coefficients[[2]] #finds the slope
d_ag_intercept <- d_ag$coefficients[[1]] #finds the intercept

```

```{r}
# Plotting demand and supply curves

#DEMAND CURVE
d_ag <- lm(price_dollars ~ q_agg_gal, data = gas) #create linear model

d_ag_slope <- d_ag$coefficients[[2]] #finds the slope
d_ag_intercept <- d_ag$coefficients[[1]] #finds the intercept

price_fitted <- d_ag_intercept + d_ag_slope*gas$q_agg_gal #creates estimated line

aggregate_demand <- ggplot(data=gas, aes(x=q_agg_gal,y=price_dollars))+
  geom_point() +
  theme_minimal()+
  labs(x = "Quantity of gas demanded (gal)",
       y = "Price ($/gal)",
       title = "Aggregate demand for gasoline using linear regression") +
  geom_line(aes(y=price_fitted, x=q_agg_gal)) #plotted the fitted relationship on the graph

aggregate_demand

#SUPPLY CURVE

```

